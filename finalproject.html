<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Visualizing Genetic Variation in Polluted Habitsts</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js">  
</script>
<style type="text/css">
</style>
</head>


<body>
<h2>Visualizing Genetic Variation in Polluted Habitats</h2>
<p><font face='Times'>By J.C.B. Nunez</font> </p>
<p> <font face='Times'>This visualization looks at fish genetics in relationship to pollution levels </font></p>

  </tr>
</table>
<h2>Nucletide Diversity Estimates</h2>
 <table style="width:100%">
  <tr>
  	<td><h3 class = "Pi_G">Genome</h3></td>
    <td><h3 class = "A"> Gene A </h3></td>
    <td><h3 class = "B">  Gene B </h3></td>		
    <td><h3 class = "C"> Gene C </h3></td>
    <td><h3 class = "D"> Gene D </h3></td>
    <td><h3 class = "E"> Gene E </h3></td>
    <td><h3 class = "F">  Gene F</h3></td>		
    <td><h3 class = "G"> Gene G </h3></td>


  </tr>
</table>



<script>

var w = 500,
    h = 350-80;
var padding = 50;

var dataset = [

["NBH",	w+(w*0.50),h-(h*0.36),	[[0.361553521, 0.04317057], [0.323779273, 0.107926424],[0.5, 0.2]]],
["SYC",w+(w*0.50),h-(h*0.20),[[0.3561572,0.048566891],[0.431705697,0.107926424],[0.5, 0.2]]],
["P",w+(w*0.546),h-(h*0.14),[[0.307590309,0.04317057],[0.539632121,0.161889636],[0.5, 0.2]]],
["F",w+(w*0.6),h+(h*0.07),[[0.339968236,0.048566891],[0.647558546,0.215852849],[0.5, 0.2]]],
["H",w+(w*0.76),h+(h*0.07),[[0.242834455,0.032377927],[0.485668909,0.107926424],[0.5, 0.2]]],
["M",w-(w*0.15),h-(h*0.36),[[0.323779273,0.037774248],[0.485668909,0.053963212],[0.5, 0.2]]],
["SR",w-(w*0.75),h+(h*0.50),[[0.31298663,0.037774248],[0.107926424,0.053963212],[0.5, 0.2]]],
["Cline",w-(w*0.55),h-(h*0.32),[[0.323779273,0.021585285],[0.269816061,0.107926424],[0.5, 0.2]]]




];

var maxG = d3.max(dataset, function(d) {return (d[3][0][0])+(d[3][0][1]);});
var minG = d3.min(dataset, function(d) {return (d[3][0][0])-(d[3][0][1]);});

var maxA = d3.max(dataset, function(d) {return (d[3][1][0])+(d[3][1][1]);});
var minA = d3.min(dataset, function(d) {return (d[3][1][0])-(d[3][1][1]);});

var maxB = d3.max(dataset, function(d) {return (d[3][2][0])+(d[3][2][1]);});
var minB = d3.min(dataset, function(d) {return (d[3][2][0])-(d[3][2][1]);});
 

var colors = { "NBH":"red", "SYC":"yellow", "P":"brown", "F":"orange", "H":"salmon", "SR":"blue", "M":"darkblue", "NBH_SE":"grey", "SYC_SE":"grey", "P_SE":"grey", "F_SE":"grey", "H_SE":"grey", "SR_SE":"grey", "M_SE":"grey", "Cline" : "Purple" };

 var drawbox = d3.select("body").append("svg")
    .attr("width", (w*2)) 
    .attr("height", (h*2));


var g = drawbox.append("g");

var img = g.append("svg:image")
    .attr("xlink:href", "https://github.com/Jcbnunez/finalproject/blob/master/NBH_Sites_Map4.png?raw=true")
    .attr("width", w*2)
    .attr("height", h*2);

  //x,y coordinates for populations
  //Cline -> x = w-(w*0.55), y = h-(h*0.32)
  //NBH ->  x = w+(w*0.50), y = h-(h*0.36)
  //SYC -> x = w+(w*0.50), y = h-(h*0.20)
  //P -> x =  w+ (w*0.546), y = h - (h*0.14)
  //F -> x = w + (w*0.6), y = h + (h*0.07)
  //H -> x = w + (w*0.76), y =  h + (h*0.07)
  //M -> x = w - (w*0.15), y = h - (h*0.36)
  //SR -> x = w - (w*0.75), y = h + (h*0.50)



 //standing

 drawbox.selectAll("circle")
			.data(dataset)
			.transition().duration(1000).ease("cubic-in-out").delay(100)

	
var r_scale = d3.scale.linear()
		.domain([minG, maxG])
		.range([10, 30]); 


drawbox.selectAll("circle.M")
	.data(dataset)
	.enter()
	.append("circle")
	.attr("class", "M")
	.attr("cx", function(d) {return d[1];})
	.attr("cy", function(d) {return d[2];})
	.attr("r", function(d) {return r_scale(d[3][0][0]);})
	.attr("fill", function(d) {return colors[d[0]];})
	.attr("opacity", 0.8);

drawbox.selectAll("circle.S")
	.data(dataset)
	.enter()
	.append("circle")
	.attr("class", "S")
	.attr("cx", function(d) {return d[1];})
	.attr("cy", function(d) {return d[2];})
	.attr("r", function(d) {return (r_scale(d[3][0][0]) + r_scale(d[3][0][1]));})
	.attr("fill", function(d) {return colors[d[0]];})
	.attr("opacity", 0.4)
	.attr("style", "stroke: black;")
	.each(pulse)
	;

function pulse() {
			var circle = drawbox.selectAll("circle.S");
			(function repeat() {
				circle = circle.transition()
					.duration(2000)
					.attr("stroke-width", 2)
					.attr("r", function(d) {return (r_scale(d[3][0][0]) - r_scale(d[3][0][1]));})
					.transition()
					.duration(2000)
					.attr('stroke-width', 2)
					.attr("r", function(d) {return (r_scale(d[3][0][0]) + r_scale(d[3][0][1]));})
					.ease('sine')
					.each("end", repeat);
			})();}



//Gene A

d3.select("h3.A").on("click", function() {
   	durac = 100;
	
r_scale.domain([minA, maxA]);

drawbox.selectAll("circle.M")
.transition().duration(durac).ease("cubic-in-out")
	.attr("r", function(d) {return r_scale(d[3][1][0]);});

drawbox.selectAll("circle.S")
.transition().duration(durac).ease("cubic-in-out")
	.attr("r", function(d) {return (r_scale(d[3][1][0]) + r_scale(d[3][1][1]));})
	.each(pulse)
	;

function pulse() {
			var circle = drawbox.selectAll("circle.S");
			(function repeat() {
				circle = circle.transition()
					.duration(2000)
					.attr("stroke-width", 2)
					.attr("r", function(d) {return (r_scale(d[3][1][0]) - r_scale(d[3][1][1]));})
					.transition()
					.duration(2000)
					.attr('stroke-width', 2)
					.attr("r", function(d) {return (r_scale(d[3][1][0]) + r_scale(d[3][1][1]));})
					.ease('sine')
					.each("end", repeat);
			})();}

});

//Global

d3.select("h3.B").on("click", function() {
   	durac = 100;
	
r_scale.domain([minG, maxG]);


drawbox.selectAll("circle.M")
.transition().duration(durac).ease("cubic-in-out")
	.attr("r", function(d) {return r_scale(d[3][0][0]);});

drawbox.selectAll("circle.S")
.transition().duration(durac).ease("cubic-in-out")
	.attr("r", function(d) {return (r_scale(d[3][0][0]) + r_scale(d[3][0][1]));})
	.attr("fill", function(d) {return colors[d[0]];})
	.each(pulse)
	;

function pulse() {
			var circle = drawbox.selectAll("circle.S");
			(function repeat() {
				circle = circle.transition()
					.duration(2000)
					.attr("stroke-width", 2)
					.attr("r", function(d) {return (r_scale(d[3][0][0]) - r_scale(d[3][0][1]));})
					.transition()
					.duration(2000)
					.attr('stroke-width', 2)
					.attr("r", function(d) {return (r_scale(d[3][0][0]) + r_scale(d[3][0][1]));})
					.ease('sine')
					.each("end", repeat);
			})();}

});

//test

d3.select("h3.B").on("click", function() {
   	durac = 100;

r_scale.domain([minB, maxB]);

drawbox.selectAll("circle.M")
.transition().duration(durac).ease("cubic-in-out")
	.attr("r", function(d) {return r_scale(d[3][2][0]);});

drawbox.selectAll("circle.S")
.transition().duration(durac).ease("cubic-in-out")
	.attr("r", function(d) {return (r_scale(d[3][2][0]) + r_scale(d[3][2][1]));})
	.each(pulse)
	;

function pulse() {
			var circle = drawbox.selectAll("circle.S");
			(function repeat() {
				circle = circle.transition()
					.duration(2000)
					.attr("stroke-width", 2)
					.attr("r", function(d) {return (r_scale(d[3][2][0]) - r_scale(d[3][2][1]));})
					.transition()
					.duration(2000)
					.attr('stroke-width', 2)
					.attr("r", function(d) {return (r_scale(d[3][2][0]) + r_scale(d[3][2][1]));})
					.ease('sine')
					.each("end", repeat);
			})();}

});

 </script>
 </body>

